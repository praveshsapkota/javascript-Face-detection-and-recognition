<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAS</title>
    <link rel="stylesheet" href="/static/frontend.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script type="text/javascript" src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>

</head>
<body>
    <canvas id="canvas" class="d-none"></canvas>
    <div class="webcam">
        <video id="webcam" autoplay playsinline width="500" height="300"></video>
    </div>
    <div class="buttons">
        <button id="start">start</button>
        <button id="stop">stop</button>
        <button id="snap">snap</button>
    </div>
    <hr>
    <div class="container">
        <div class="row clicked_images">
            
        </div>
        
    </div>
    <hr>
    <button id="uplode" style='margin-left: 450px;'>uplode</button>
    <br>
    <br>


    <div class="form_data">
        <form action="/submitt_data" method="post">
            <input type="text" placeholder="Full_Name" name="name">
            <input type="text" placeholder="Department" name="department">
            <button id="submitt">submitt_data</button>
        </form>
    </div>
    

    <script>
        $(document).ready(function(){

const webcamElement = $('#webcam')[0];
const canvasElement = $('#canvas')[0];
const webcam = new Webcam(webcamElement, 'user', canvasElement);
const socket = io();



$("#start").on('click',function(){
    webcam.start()
   .then(result =>{
      console.log("webcam started");
   })
   .catch(err => {
       console.log(err);
   });
});

$("#stop").on('click',function(){
    webcam.stop();
    webcamElement.srcObject = null;
});


imagedata = [];
var i = 0;


$("#snap").on('click',function(){
    var pic = webcam.snap();
    canvasElement.remove();
    imagedata.push(pic);
    var img = $('<img></img>').attr({
        id:"imgclicked"+[i],
        src:imagedata[i],
        class:'imgview'+' '+'img-fluid'
    });
    $('.clicked_images').append(img);
    i++;
});

var choosed_image_no = [];

$('div.clicked_images').click(function(event){
    choosed_image_no.push($(event.target)[0].id);
    $(event.target).attr({
        class:'selected'+' '+'imgview'+' '+'img-fluid'
    });

})


var choosed_image = [];
var k;
function choose_image(){
    for(k=0;k<choosed_image_no.length;k++){
        var id = choosed_image_no[k];
        var img = $('#'+id).attr('src');
        choosed_image.push(img);

    }
};


$('#uplode').on('click',function(){
    choose_image();
    console.log(choosed_image);
})
socket.on('connect', () => {
    $('body').append('<p>connected</p>');
  });
$('#submitt').on('click',function(){
    socket.emit('imgdata',choosed_image);

    
})










});
    </script>

    
</body>
</html>